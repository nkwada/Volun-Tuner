<div class="row">
	<div class="col-4"><!-- 全件表示ここから -->
		<div class="card shadow text-center">
		  <div class="card-header">
		    新着順に全件表示
		  </div>
		  <div class="card-body">
		  	<%= link_to "ボランティアを見る", events_search_path, class: "btn btn-outline-primary shadow-sm rounded-pill" %>
		  </div>
		</div>
	</div><!-- 全件表示ここまで -->

	<div class="col-8"><!-- フリーワード検索ここから -->
		<div class="card shadow text-center">
			<div class="card-header">
			フリーワード検索
			</div>
			<div class="card-body">
				<!-- 検索フォームの表示 -->
				<%= form_with url:events_search_path, :method => 'get', local: true do |f| %>
					<%= f.select :selected, [['タイトル','Title'],['内容','Content']] %>
				 	<%= f.search_field :search, :size=>"40", class: "border shadow-sm" %>
				  	<%= f.submit '検索する', name: nil, class: "btn btn-dark btn-sm shadow-sm" %>
				<% end %>
				<!-- ここまで -->
			</div>
		</div>
	</div><!-- フリーワード検索ここまで -->
</div>

<hr>

<div class="row">
	<div class="col-4"><!-- 現在地検索ここから -->
		<div class="card shadow text-center">
			  <div class="card-header">
			    現在地から近い順に表示
			  </div>

			  <div class="card-body row">

			　		<button id="button" onclick="getPosition();" class="btn btn-outline-danger shadow-sm mx-auto">現在地から探す</button>

					<!-- ボタンを押すとスピナーを表示 -->
					<div id="overlay">
					    <div class="cv-spinner">
					        <span class="spinner"></span>
					    </div>
					</div>

			  </div>
		</div>
	</div><!-- 現在地検索ここまで -->

	<div class="col-8"><!-- タグ検索ここから -->
		<div class="card shadow text-center">
		  <div class="card-header">
		    タグで検索
		  </div>
		  <div class="card-body">
		  	<div class="row justify-content-center mb-2">
				<%= link_to "ゴミ拾い", events_search_path(tag_name: "ゴミ拾い"), class: "btn-sm btn-info mr-2" %>
				<%= link_to "募金", events_search_path(tag_name: "募金"), class: "btn-sm btn-info mr-2" %>
				<%= link_to "東京オリンピック", events_search_path(tag_name: "東京オリンピック"), class: "btn-sm btn-info mr-2" %>
				<%= link_to "災害支援", events_search_path(tag_name: "災害支援"), class: "btn-sm btn-info mr-2" %>
				<%= link_to "動物保護", events_search_path(tag_name: "動物保護"), class: "btn-sm btn-info mr-2" %>
				<%= link_to "飢餓", events_search_path(tag_name: "飢餓"), class: "btn-sm btn-info mr-2" %>
				<%= link_to "台風", events_search_path(tag_name: "台風"), class: "btn-sm btn-info mr-2" %>
				<%= link_to "熊本地震", events_search_path(tag_name: "熊本地震"), class: "btn-sm btn-info mr-2" %>
		  	</div>
		  	<div class="row justify-content-center">
				<%= link_to "難民", events_search_path(tag_name: "難民"), class: "btn-sm btn-info mr-2" %>
				<%= link_to "教育", events_search_path(tag_name: "教育"), class: "btn-sm btn-info mr-2" %>
				<%= link_to "障害者", events_search_path(tag_name: "障害者"), class: "btn-sm btn-info mr-2" %>
				<%= link_to "子供", events_search_path(tag_name: "子供"), class: "btn-sm btn-info mr-2" %>
				<%= link_to "スポーツ", events_search_path(tag_name: "スポーツ"), class: "btn-sm btn-info mr-2" %>
				<%= link_to "女性", events_search_path(tag_name: "女性"), class: "btn-sm btn-info mr-2" %>
				<%= link_to "宗教", events_search_path(tag_name: "宗教"), class: "btn-sm btn-info mr-2" %>
				<%= link_to "国際協力", events_search_path(tag_name: "国際協力"), class: "btn-sm btn-info mr-2" %>
				<%= link_to "環境", events_search_path(tag_name: "環境"), class: "btn-sm btn-info mr-2" %>
				<%= link_to "農業", events_search_path(tag_name: "農業"), class: "btn-sm btn-info mr-2" %>
				<%= link_to "衛生", events_search_path(tag_name: "衛生"), class: "btn-sm btn-info mr-2" %>
		  	</div>

		  </div>
		</div>
	</div><!-- タグ検索ここまで -->
</div>

<hr>

<div class="row">
	<div class="col-6"><!-- カレンダーここから -->
		<div class="card shadow text-center">
			<div class="card-header">
				カレンダー
			</div>
			<div class="card-body">
				<div id="calendar">
					<%= render 'calendar_index' %>
				</div>

			</div>
		</div>
	</div><!-- カレンダーここまで -->

	<div class="col-6"><!-- エリア検索ここから -->
		<div class="card shadow text-center">
			<div class="card-header">
				エリアで探す
			</div>
			<div class="card-body">

				<%= render 'japan_map' %>

			</div>
		</div>
	</div><!-- エリア検索ここまで -->
</div>


<!-- エリア選択の記述 -->
<script>
$(function(){
    //地域を選択
    $('.area_btn').click(function(){
        $('.area_overlay').show();
        $('.pref_area').show();
        var area = $(this).data('area');
        $('[data-list]').hide();
        $('[data-list="' + area + '"]').show();
    });

    //レイヤーをタップ
    $('.area_overlay').click(function(){
        prefReset();
    });

    //都道府県をクリック
    $('.pref_list [data-id]').click(function(){
        if($(this).data('id')){
            var id = $(this).data('id');
            //このidを使用して行いたい操作をしてください
            //都道府県IDに応じて別ページに飛ばしたい場合はこんな風に書く↓
            //window.location.href = 'https://kinocolog.com/pref/' + id;

            prefReset();
        }
    });

    //表示リセット
    function prefReset(){
        $('[data-list]').hide();
        $('.pref_area').hide();
        $('.area_overlay').hide();
    }
});
</script>




<!-- 現在地検索の記述 -->
<script>
    // 現在地取得処理
    function getPosition() {
      // 現在地を取得
      navigator.geolocation.getCurrentPosition(
        // 取得成功した場合
        function(position) {
            window.location.href = "/events/search?latitude="+position.coords.latitude+"&longitude="+position.coords.longitude
            // $.ajax({
            //   url: "/events/search_location",
            //   type: "GET",
            //   dataType: 'html',
            //   data: {latitude : position.coords.latitude,
            //         longitude : position.coords.longitude},
            // });
        },
        // 取得失敗した場合
        function(error) {
          switch(error.code) {
            case 1: //PERMISSION_DENIED
              alert("位置情報の利用が許可されていません");
              break;
            case 2: //POSITION_UNAVAILABLE
              alert("現在位置が取得できませんでした");
              break;
            case 3: //TIMEOUT
              alert("タイムアウトになりました");
              break;
            default:
              alert("その他のエラー(エラーコード:"+error.code+")");
              break;
          }
        }
      );
    }
</script>


<!-- 現在地検索のスピナー -->
<script>
jQuery(function($){
    $(document).ajaxSend(function() {
        $("#overlay").fadeIn(700);
    });

    $('#button').click(function(){
        $.ajax({
            type: 'GET',
            success: function(data){
                console.log(data);
            }
        }).done(function() {
            setTimeout(function(){
                $("#overlay").fadeOut(700);
            },700);
        });
    });
});
</script>